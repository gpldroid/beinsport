<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Kooralist - Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± ÙˆØ¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS Player -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <!-- Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            DEFAULT: '#E50914',
                            dark: '#B20710',
                            light: '#FF2D2D'
                        },
                        dark: {
                            DEFAULT: '#0f0f0f',
                            light: '#1a1a1a',
                            lighter: '#2a2a2a'
                        },
                        light: {
                            DEFAULT: '#f8f9fa',
                            dark: '#e9ecef'
                        }
                    },
                    screens: {
                        'xs': '405px',
                        '3xl': '1920px',
                        '4xl': '2560px',
                    }
                }
            }
        }
    </script>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            transition: all 0.3s ease;
        }

        /* Netflix Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: #E50914;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #FF2D2D;
        }

        /* Full Responsive Video Container */
        .video-wrapper {
            position: relative;
            width: 100%;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
        }

        .video-wrapper video {
            width: 100%;
            height: auto;
            max-height: 70vh;
            object-fit: contain;
        }

        /* Responsive Grid System */
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        @media (max-width: 640px) {
            .matches-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
            }
        }

        @media (min-width: 1536px) {
            .matches-grid {
                grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
                gap: 25px;
            }
            
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
                gap: 16px;
            }
        }

        /* Custom Cards */
        .match-card {
            background: linear-gradient(145deg, #1a1a1a, #151515);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .match-card:hover {
            transform: translateY(-4px);
            border-color: rgba(229, 9, 20, 0.3);
            box-shadow: 0 12px 40px rgba(229, 9, 20, 0.15);
        }

        .channel-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            transition: all 0.2s ease;
        }

        .channel-card:hover {
            background: rgba(229, 9, 20, 0.1);
            border-color: rgba(229, 9, 20, 0.4);
            transform: scale(1.02);
        }

        .channel-card.active {
            background: rgba(229, 9, 20, 0.15);
            border-color: #E50914;
        }

        /* Light Mode */
        body.light-mode .match-card {
            background: white;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body.light-mode .channel-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
        }

        /* Loading Animation */
        .loader {
            border: 3px solid rgba(229, 9, 20, 0.2);
            border-radius: 50%;
            border-top: 3px solid #E50914;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Live Indicator */
        .live-indicator {
            background: linear-gradient(45deg, #E50914, #dc2626);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Responsive Header */
        .header-container {
            background: rgba(15, 15, 15, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.light-mode .header-container {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
        }

        @media (max-width: 768px) {
            .desktop-menu {
                display: none;
            }
            
            .mobile-menu {
                display: flex;
            }
        }

        /* Player Controls */
        .player-controls {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .video-wrapper:hover .player-controls {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-dark text-white min-h-screen light-mode:bg-light light-mode:text-gray-900">

    <!-- Header -->
    <header class="sticky top-0 z-50 header-container">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
                        <i class="ph ph-soccer-ball text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">Kooralist</h1>
                        <p class="text-xs text-gray-400 light-mode:text-gray-600">Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙˆØ§Ù„Ø±ÙŠØ§Ø¶Ø©</p>
                    </div>
                </div>

                <!-- Desktop Menu -->
                <div class="desktop-menu flex items-center gap-6">
                    <button onclick="scrollToSection('iptv-section')" 
                            class="flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-white/10 light-mode:hover:bg-gray-100 transition">
                        <i class="ph ph-play-circle"></i>
                        <span>Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</span>
                    </button>
                    
                    <button onclick="scrollToSection('matches-section')"
                            class="flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-white/10 light-mode:hover:bg-gray-100 transition">
                        <i class="ph ph-calendar"></i>
                        <span>Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</span>
                    </button>
                    
                    <div class="flex items-center gap-3">
                        <span class="text-sm">Ù…Ø¸Ù„Ù…</span>
                        <div class="relative">
                            <input type="checkbox" id="themeToggle" class="hidden" onchange="toggleTheme()">
                            <label for="themeToggle" class="w-12 h-6 bg-gray-700 rounded-full cursor-pointer flex items-center p-1 transition-all duration-300 light-mode:bg-gray-300">
                                <div class="w-4 h-4 bg-white rounded-full transform transition-transform duration-300"></div>
                            </label>
                        </div>
                        <span class="text-sm">ÙØ§ØªØ­</span>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="mobile-menu p-2 rounded-lg hover:bg-white/10">
                    <i class="ph ph-list text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="fixed top-16 right-0 left-0 bg-dark border-t border-white/10 light-mode:bg-white light-mode:border-gray-200 z-40 hidden">
        <div class="container mx-auto px-4 py-4 space-y-3">
            <button onclick="scrollToSection('iptv-section'); toggleMobileMenu()"
                    class="w-full flex items-center justify-center gap-2 py-3 rounded-lg hover:bg-white/10 light-mode:hover:bg-gray-100">
                <i class="ph ph-play-circle"></i>
                Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
            </button>
            <button onclick="scrollToSection('matches-section'); toggleMobileMenu()"
                    class="w-full flex items-center justify-center gap-2 py-3 rounded-lg hover:bg-white/10 light-mode:hover:bg-gray-100">
                <i class="ph ph-calendar"></i>
                Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
            </button>
            <div class="flex items-center justify-center gap-3 py-3">
                <span>Ù…Ø¸Ù„Ù…</span>
                <div class="relative">
                    <input type="checkbox" id="themeToggleMobile" class="hidden" onchange="toggleTheme()">
                    <label for="themeToggleMobile" class="w-12 h-6 bg-gray-700 rounded-full cursor-pointer flex items-center p-1 transition-all duration-300 light-mode:bg-gray-300">
                        <div class="w-4 h-4 bg-white rounded-full transform transition-transform duration-300"></div>
                    </label>
                </div>
                <span>ÙØ§ØªØ­</span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- IPTV Section -->
        <section id="iptv-section" class="mb-16">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl md:text-3xl font-bold flex items-center gap-3">
                    <i class="ph ph-television text-primary"></i>
                    Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
                </h2>
                <span id="channelCount" class="text-sm text-gray-400 bg-dark-lighter px-3 py-1 rounded-full">0 Ù‚Ù†Ø§Ø©</span>
            </div>

            <!-- Player -->
            <div class="video-wrapper mb-8">
                <video id="videoPlayer" class="w-full" controls></video>
                <div id="playerPlaceholder" class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-black/80 to-black">
                    <i class="ph ph-television text-6xl text-gray-400 mb-4"></i>
                    <p class="text-xl text-gray-300 mb-2">Ø§Ø®ØªØ± Ù‚Ù†Ø§Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</p>
                    <p class="text-sm text-gray-400">Ø¢Ù„Ø§Ù Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</p>
                </div>
            </div>

            <!-- Sources Tabs -->
            <div class="mb-6">
                <div class="flex flex-wrap gap-2 mb-4">
                    <button onclick="loadSource('sports')" 
                            class="px-4 py-2 rounded-lg bg-primary text-white font-medium">
                        âš½ Ø±ÙŠØ§Ø¶ÙŠØ©
                    </button>
                    <button onclick="loadSource('entertainment')"
                            class="px-4 py-2 rounded-lg bg-dark-lighter hover:bg-white/10 light-mode:bg-gray-100 light-mode:hover:bg-gray-200 transition">
                        ğŸ¬ ØªØ±ÙÙŠÙ‡ÙŠØ©
                    </button>
                    <button onclick="loadSource('news')"
                            class="px-4 py-2 rounded-lg bg-dark-lighter hover:bg-white/10 light-mode:bg-gray-100 light-mode:hover:bg-gray-200 transition">
                        ğŸ“» Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©
                    </button>
                    <button onclick="loadSource('kids')"
                            class="px-4 py-2 rounded-lg bg-dark-lighter hover:bg-white/10 light-mode:bg-gray-100 light-mode:hover:bg-gray-200 transition">
                        ğŸ® Ø£Ø·ÙØ§Ù„
                    </button>
                    <button onclick="loadSource('all')"
                            class="px-4 py-2 rounded-lg bg-dark-lighter hover:bg-white/10 light-mode:bg-gray-100 light-mode:hover:bg-gray-200 transition">
                        ğŸŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
                    </button>
                </div>

                <!-- Search and Filter -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="relative">
                        <i class="ph ph-magnifying-glass absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <input type="text" id="channelSearch" 
                               placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©..."
                               class="w-full bg-dark-lighter border border-white/10 rounded-lg py-3 pr-10 pl-4 focus:outline-none focus:ring-2 focus:ring-primary light-mode:bg-white light-mode:border-gray-300">
                    </div>
                    
                    <select id="countryFilter" 
                            class="bg-dark-lighter border border-white/10 rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-primary light-mode:bg-white light-mode:border-gray-300">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„</option>
                    </select>
                    
                    <select id="categoryFilter" 
                            class="bg-dark-lighter border border-white/10 rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-primary light-mode:bg-white light-mode:border-gray-300">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
                    </select>
                </div>
            </div>

            <!-- Channels Grid -->
            <div class="channels-grid-container">
                <div id="channelsList" class="channels-grid">
                    <!-- Channels will be loaded here -->
                </div>
            </div>

            <!-- Load More -->
            <div class="text-center mt-8">
                <button id="loadMoreBtn" onclick="loadMoreChannels()"
                        class="px-6 py-3 bg-dark-lighter hover:bg-white/10 rounded-lg font-medium transition light-mode:bg-gray-100 light-mode:hover:bg-gray-200">
                    Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù‚Ù†ÙˆØ§Øª
                </button>
            </div>
        </section>

        <!-- Matches Section -->
        <section id="matches-section" class="mb-16">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
                <h2 class="text-2xl md:text-3xl font-bold flex items-center gap-3">
                    <i class="ph ph-calendar text-primary"></i>
                    Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
                </h2>
                
                <div class="flex flex-wrap gap-4">
                    <!-- Date Navigation -->
                    <div class="flex items-center bg-dark-lighter rounded-lg overflow-hidden light-mode:bg-gray-100">
                        <button onclick="changeDate(-1)" 
                                class="p-3 hover:bg-white/10 light-mode:hover:bg-gray-200 transition">
                            <i class="ph ph-caret-right"></i>
                        </button>
                        <input type="date" id="datePicker" 
                               class="bg-transparent px-4 py-2 text-center min-w-[150px] focus:outline-none">
                        <button onclick="changeDate(1)" 
                                class="p-3 hover:bg-white/10 light-mode:hover:bg-gray-200 transition">
                            <i class="ph ph-caret-left"></i>
                        </button>
                    </div>
                    
                    <!-- Filters -->
                    <div class="flex gap-2">
                        <select id="leagueFilter" 
                                class="bg-dark-lighter border border-white/10 rounded-lg px-4 py-2 min-w-[180px] focus:outline-none focus:ring-2 focus:ring-primary light-mode:bg-white light-mode:border-gray-300">
                            <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</option>
                        </select>
                        
                        <button id="liveMatchesBtn" onclick="toggleLiveMatches()"
                                class="px-4 py-2 bg-dark-lighter rounded-lg hover:bg-white/10 light-mode:bg-gray-100 light-mode:hover:bg-gray-200 transition flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span>
                            Ù…Ø¨Ø§Ø´Ø± ÙÙ‚Ø·
                        </button>
                    </div>
                </div>
            </div>

            <!-- Matches Grid -->
            <div id="matchesContainer" class="matches-grid">
                <!-- Matches will be loaded here -->
            </div>

            <!-- Loading More Matches -->
            <div class="text-center mt-8">
                <button id="loadMoreMatchesBtn" onclick="loadMoreMatches()"
                        class="px-6 py-3 bg-dark-lighter hover:bg-white/10 rounded-lg font-medium transition light-mode:bg-gray-100 light-mode:hover:bg-gray-200">
                    ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø£ÙƒØ«Ø±
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-dark-lighter border-t border-white/10 light-mode:bg-gray-100 light-mode:border-gray-200 py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <h3 class="font-bold text-lg mb-4">Ø¹Ù† Kooralist</h3>
                    <p class="text-gray-400 light-mode:text-gray-600 text-sm leading-relaxed">
                        Ù…Ù†ØµØ© Ø±ÙŠØ§Ø¶ÙŠØ© Ø´Ø§Ù…Ù„Ø© ØªÙˆÙØ± Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ø£Ù„Ø§Ù Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© ÙˆØ§Ù„Ø¹Ø±Ø¨ÙŠØ©.
                    </p>
                </div>
                
                <div>
                    <h3 class="font-bold text-lg mb-4">Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="font-bold text-lg mb-4">Ø§Ù„Ù‚Ù†ÙˆØ§Øª</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠØ©</a></li>
                        <li><a href="#" class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm">Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø£ÙÙ„Ø§Ù…</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="font-bold text-lg mb-4">Ø§Ù„Ù…ØµØ§Ø¯Ø±</h3>
                    <ul class="space-y-2">
                        <li>
                            <a href="https://github.com/iptv-org/iptv" target="_blank" 
                               class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm flex items-center gap-2">
                                <i class="ph ph-github-logo"></i>
                                IPTV GitHub
                            </a>
                        </li>
                        <li>
                            <a href="https://www.api-football.com" target="_blank"
                               class="text-gray-400 light-mode:text-gray-600 hover:text-primary transition text-sm flex items-center gap-2">
                                <i class="ph ph-link"></i>
                                API Football
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="pt-8 border-t border-white/10 light-mode:border-gray-300 text-center">
                <p class="text-gray-400 light-mode:text-gray-600 text-sm">
                    Â© 2024 Kooralist. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©. Ù‡Ø°Ø§ Ù…ÙˆÙ‚Ø¹ ØªØ¬Ø±ÙŠØ¨ÙŠ.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Configuration
        const CONFIG = {
            API_KEY: '219afb927d14c7f9ba7132adf83e0a4f',
            API_HOST: 'v3.football.api-sports.io',
            
            // Ø¬Ù…ÙŠØ¹ Ù…ØµØ§Ø¯Ø± IPTV
            IPTV_SOURCES: {
                sports: 'https://iptv-org.github.io/iptv/categories/sports.m3u',
                entertainment: 'https://iptv-org.github.io/iptv/categories/entertainment.m3u',
                news: 'https://iptv-org.github.io/iptv/categories/news.m3u',
                kids: 'https://iptv-org.github.io/iptv/categories/kids.m3u',
                all: 'https://iptv-org.github.io/iptv/index.m3u'
            },
            
            // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠØ©
            COUNTRIES: {
                'sa': 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©',
                'ae': 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª',
                'eg': 'Ù…ØµØ±',
                'ma': 'Ø§Ù„Ù…ØºØ±Ø¨',
                'dz': 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±',
                'tn': 'ØªÙˆÙ†Ø³',
                'jo': 'Ø§Ù„Ø£Ø±Ø¯Ù†',
                'lb': 'Ù„Ø¨Ù†Ø§Ù†',
                'kw': 'Ø§Ù„ÙƒÙˆÙŠØª',
                'qa': 'Ù‚Ø·Ø±',
                'bh': 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†',
                'om': 'Ø¹Ù…Ø§Ù†',
                'us': 'Ø£Ù…Ø±ÙŠÙƒØ§',
                'uk': 'Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ§',
                'fr': 'ÙØ±Ù†Ø³Ø§',
                'es': 'Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§',
                'it': 'Ø¥ÙŠØ·Ø§Ù„ÙŠØ§',
                'de': 'Ø£Ù„Ù…Ø§Ù†ÙŠØ§'
            }
        };

        // State Management
        const state = {
            theme: localStorage.getItem('theme') || 'dark',
            currentDate: new Date().toISOString().split('T')[0],
            
            // IPTV State
            channels: [],
            filteredChannels: [],
            displayedChannels: 50,
            currentSource: 'sports',
            currentChannel: null,
            hls: null,
            countries: new Set(),
            categories: new Set(),
            
            // Matches State
            matches: [],
            filteredMatches: [],
            displayedMatches: 12,
            showLiveOnly: false,
            currentLeague: 'all'
        };

        // DOM Elements
        const elements = {
            // Theme
            themeToggle: document.getElementById('themeToggle'),
            themeToggleMobile: document.getElementById('themeToggleMobile'),
            
            // Mobile Menu
            mobileMenu: document.getElementById('mobileMenu'),
            
            // IPTV Elements
            videoPlayer: document.getElementById('videoPlayer'),
            playerPlaceholder: document.getElementById('playerPlaceholder'),
            channelCount: document.getElementById('channelCount'),
            channelsList: document.getElementById('channelsList'),
            channelSearch: document.getElementById('channelSearch'),
            countryFilter: document.getElementById('countryFilter'),
            categoryFilter: document.getElementById('categoryFilter'),
            loadMoreBtn: document.getElementById('loadMoreBtn'),
            
            // Matches Elements
            datePicker: document.getElementById('datePicker'),
            matchesContainer: document.getElementById('matchesContainer'),
            leagueFilter: document.getElementById('leagueFilter'),
            liveMatchesBtn: document.getElementById('liveMatchesBtn'),
            loadMoreMatchesBtn: document.getElementById('loadMoreMatchesBtn')
        };

        // Initialize App
        function init() {
            // Apply theme
            applyTheme();
            
            // Set current date
            elements.datePicker.value = state.currentDate;
            
            // Load initial data
            loadChannels('sports');
            loadMatches(state.currentDate);
            
            // Setup event listeners
            setupEventListeners();
            
            // Populate country filter
            populateCountryFilter();
        }

        // Apply Theme
        function applyTheme() {
            if (state.theme === 'light') {
                document.body.classList.add('light-mode');
                if (elements.themeToggle) elements.themeToggle.checked = true;
                if (elements.themeToggleMobile) elements.themeToggleMobile.checked = true;
            } else {
                document.body.classList.remove('light-mode');
            }
        }

        // Toggle Theme
        function toggleTheme() {
            state.theme = state.theme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', state.theme);
            applyTheme();
        }

        // Toggle Mobile Menu
        function toggleMobileMenu() {
            elements.mobileMenu.classList.toggle('hidden');
        }

        // Scroll to Section
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ 
                behavior: 'smooth' 
            });
            toggleMobileMenu();
        }

        // Setup Event Listeners
        function setupEventListeners() {
            // Channel search
            elements.channelSearch.addEventListener('input', () => {
                filterChannels();
            });
            
            // Country filter
            elements.countryFilter.addEventListener('change', () => {
                filterChannels();
            });
            
            // Category filter
            elements.categoryFilter.addEventListener('change', () => {
                filterChannels();
            });
            
            // Date picker
            elements.datePicker.addEventListener('change', (e) => {
                state.currentDate = e.target.value;
                loadMatches(state.currentDate);
            });
            
            // League filter
            elements.leagueFilter.addEventListener('change', (e) => {
                state.currentLeague = e.target.value;
                filterMatches();
            });
        }

        // Populate Country Filter
        function populateCountryFilter() {
            for (const [code, name] of Object.entries(CONFIG.COUNTRIES)) {
                elements.countryFilter.innerHTML += `
                    <option value="${code}">${name}</option>
                `;
            }
        }

        // Load Channels from Source
        async function loadSource(source) {
            state.currentSource = source;
            state.displayedChannels = 50;
            
            // Reset filters
            elements.channelSearch.value = '';
            elements.countryFilter.value = '';
            elements.categoryFilter.value = '';
            
            // Show loading
            elements.channelsList.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <div class="loader mx-auto mb-4"></div>
                    <p class="text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª...</p>
                </div>
            `;
            
            // Load channels
            await loadChannels(source);
        }

        // Load Channels
        async function loadChannels(source) {
            try {
                const url = CONFIG.IPTV_SOURCES[source];
                const response = await fetch(url);
                const text = await response.text();
                
                parseM3U(text);
                filterChannels();
            } catch (error) {
                console.error('Error loading channels:', error);
                elements.channelsList.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="ph ph-warning text-4xl text-red-500 mb-4"></i>
                        <p class="text-red-400">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª</p>
                        <p class="text-sm text-gray-400 mt-2">${error.message}</p>
                    </div>
                `;
            }
        }

        // Parse M3U Playlist
        function parseM3U(data) {
            const lines = data.split('\n');
            state.channels = [];
            state.countries.clear();
            state.categories.clear();
            
            let currentChannel = {};
            
            lines.forEach(line => {
                line = line.trim();
                
                if (line.startsWith('#EXTINF:')) {
                    // Extract channel name
                    const nameMatch = line.match(/tvg-name="([^"]*)"/) || 
                                     line.match(/,(.+)$/);
                    currentChannel.name = nameMatch ? nameMatch[1] : 'Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
                    
                    // Extract logo
                    const logoMatch = line.match(/tvg-logo="([^"]*)"/);
                    currentChannel.logo = logoMatch ? logoMatch[1] : null;
                    
                    // Extract group (category)
                    const groupMatch = line.match(/group-title="([^"]*)"/);
                    currentChannel.group = groupMatch ? groupMatch[1] : 'Ø¹Ø§Ù…';
                    
                    // Extract country
                    const countryMatch = line.match(/tvg-country="([^"]*)"/);
                    currentChannel.country = countryMatch ? countryMatch[1] : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    
                    if (currentChannel.group) {
                        state.categories.add(currentChannel.group);
                    }
                    
                    if (currentChannel.country && currentChannel.country !== 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯') {
                        state.countries.add(currentChannel.country);
                    }
                    
                } else if (line.startsWith('http')) {
                    currentChannel.url = line;
                    if (currentChannel.name && currentChannel.url) {
                        state.channels.push({...currentChannel});
                    }
                    currentChannel = {};
                }
            });
            
            // Update category filter
            updateCategoryFilter();
            
            elements.channelCount.textContent = `${state.channels.length} Ù‚Ù†Ø§Ø©`;
        }

        // Update Category Filter
        function updateCategoryFilter() {
            elements.categoryFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>';
            state.categories.forEach(category => {
                elements.categoryFilter.innerHTML += `
                    <option value="${category}">${category}</option>
                `;
            });
        }

        // Filter Channels
        function filterChannels() {
            const searchTerm = elements.channelSearch.value.toLowerCase();
            const selectedCountry = elements.countryFilter.value;
            const selectedCategory = elements.categoryFilter.value;
            
            state.filteredChannels = state.channels.filter(channel => {
                // Search filter
                const matchesSearch = !searchTerm || 
                    channel.name.toLowerCase().includes(searchTerm) ||
                    (channel.group && channel.group.toLowerCase().includes(searchTerm));
                
                // Country filter
                const matchesCountry = !selectedCountry || 
                    channel.country === selectedCountry;
                
                // Category filter
                const matchesCategory = !selectedCategory || 
                    channel.group === selectedCategory;
                
                return matchesSearch && matchesCountry && matchesCategory;
            });
            
            renderChannels();
        }

        // Render Channels
        function renderChannels() {
            const channelsToShow = state.filteredChannels.slice(0, state.displayedChannels);
            
            if (channelsToShow.length === 0) {
                elements.channelsList.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="ph ph-television text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ù†ÙˆØ§Øª</p>
                        <p class="text-sm text-gray-400 mt-2">Ø¬Ø±Ø¨ Ø¨Ø­Ø«Ø§Ù‹ Ù…Ø®ØªÙ„ÙØ§Ù‹</p>
                    </div>
                `;
                elements.loadMoreBtn.style.display = 'none';
                return;
            }
            
            let html = '';
            channelsToShow.forEach((channel, index) => {
                const isActive = state.currentChannel && state.currentChannel.url === channel.url;
                
                html += `
                    <div class="channel-card p-3 cursor-pointer ${isActive ? 'active' : ''}"
                         onclick="playChannel(${index})">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 rounded-lg bg-dark-lighter light-mode:bg-gray-100 flex items-center justify-center overflow-hidden flex-shrink-0">
                                ${channel.logo ? 
                                    `<img src="${channel.logo}" 
                                          alt="${channel.name}"
                                          class="w-10 h-10 object-cover rounded"
                                          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                                     <div class="hidden items-center justify-center w-full h-full">
                                        <i class="ph ph-television text-gray-400 text-lg"></i>
                                     </div>` :
                                    `<div class="flex items-center justify-center w-full h-full">
                                        <i class="ph ph-television text-gray-400 text-lg"></i>
                                     </div>`
                                }
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="font-medium text-sm truncate mb-1">${channel.name}</h4>
                                <div class="flex items-center gap-2">
                                    ${channel.group ? 
                                        `<span class="text-xs text-gray-400 bg-dark px-2 py-1 rounded">${channel.group}</span>` : ''}
                                    ${channel.country && channel.country !== 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' ?
                                        `<span class="text-xs text-gray-400">${channel.country}</span>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            elements.channelsList.innerHTML = html;
            
            // Show/hide load more button
            elements.loadMoreBtn.style.display = 
                state.displayedChannels < state.filteredChannels.length ? 'block' : 'none';
        }

        // Load More Channels
        function loadMoreChannels() {
            state.displayedChannels += 50;
            renderChannels();
        }

        // Play Channel
        function playChannel(index) {
            const channel = state.filteredChannels[index];
            if (!channel) return;
            
            state.currentChannel = channel;
            
            // Update UI
            elements.playerPlaceholder.style.display = 'none';
            
            // Remove active class from all channels
            document.querySelectorAll('.channel-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected channel
            const channelCards = document.querySelectorAll('.channel-card');
            if (channelCards[index]) {
                channelCards[index].classList.add('active');
            }
            
            // Play video
            if (Hls.isSupported()) {
                if (state.hls) {
                    state.hls.destroy();
                }
                
                state.hls = new Hls({
                    enableWorker: true,
                    lowLatencyMode: true,
                    backBufferLength: 90
                });
                
                state.hls.loadSource(channel.url);
                state.hls.attachMedia(elements.videoPlayer);
                
                state.hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    elements.videoPlayer.play().catch(e => {
                        console.log('Auto-play prevented');
                    });
                });
                
            } else if (elements.videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                elements.videoPlayer.src = channel.url;
                elements.videoPlayer.addEventListener('loadedmetadata', () => {
                    elements.videoPlayer.play().catch(e => {
                        console.log('Auto-play prevented');
                    });
                });
            }
        }

        // Load Matches
        async function loadMatches(date) {
            try {
                elements.matchesContainer.innerHTML = `
                    <div class="col-span-full text-center py-16">
                        <div class="loader mx-auto mb-4"></div>
                        <p class="text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª...</p>
                    </div>
                `;
                
                const response = await fetch(
                    `https://${CONFIG.API_HOST}/fixtures?date=${date}&timezone=Asia/Riyadh`,
                    {
                        headers: {
                            'x-rapidapi-host': CONFIG.API_HOST,
                            'x-rapidapi-key': CONFIG.API_KEY
                        }
                    }
                );
                
                const data = await response.json();
                state.matches = data.response || [];
                
                // Update league filter
                updateLeagueFilter();
                
                // Render matches
                filterMatches();
                
            } catch (error) {
                console.error('Error loading matches:', error);
                elements.matchesContainer.innerHTML = `
                    <div class="col-span-full text-center py-16">
                        <i class="ph ph-warning text-4xl text-red-500 mb-4"></i>
                        <p class="text-red-400">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</p>
                        <p class="text-sm text-gray-400 mt-2">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>
                    </div>
                `;
            }
        }

        // Update League Filter
        function updateLeagueFilter() {
            const leagues = new Map();
            
            state.matches.forEach(match => {
                if (match.league && match.league.name) {
                    leagues.set(match.league.id, match.league.name);
                }
            });
            
            elements.leagueFilter.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</option>';
            leagues.forEach((name, id) => {
                elements.leagueFilter.innerHTML += `
                    <option value="${id}">${name}</option>
                `;
            });
        }

        // Filter Matches
        function filterMatches() {
            let filtered = [...state.matches];
            
            // Filter by league
            if (state.currentLeague !== 'all') {
                filtered = filtered.filter(match => 
                    match.league && match.league.id === parseInt(state.currentLeague)
                );
            }
            
            // Filter live matches
            if (state.showLiveOnly) {
                filtered = filtered.filter(match => {
                    const status = match.fixture?.status?.short;
                    return status === '1H' || status === 'HT' || status === '2H' || status === 'ET';
                });
            }
            
            state.filteredMatches = filtered;
            renderMatches();
        }

        // Render Matches
        function renderMatches() {
            const matchesToShow = state.filteredMatches.slice(0, state.displayedMatches);
            
            if (matchesToShow.length === 0) {
                elements.matchesContainer.innerHTML = `
                    <div class="col-span-full text-center py-16">
                        <i class="ph ph-calendar-blank text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª</p>
                        <p class="text-sm text-gray-400 mt-2">Ø¬Ø±Ø¨ ØªØ§Ø±ÙŠØ®Ø§Ù‹ Ù…Ø®ØªÙ„ÙØ§Ù‹</p>
                    </div>
                `;
                elements.loadMoreMatchesBtn.style.display = 'none';
                return;
            }
            
            // Group matches by league
            const matchesByLeague = {};
            matchesToShow.forEach(match => {
                const leagueId = match.league?.id || 'unknown';
                const leagueName = match.league?.name || 'Ø¨Ø·ÙˆÙ„Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
                
                if (!matchesByLeague[leagueId]) {
                    matchesByLeague[leagueId] = {
                        name: leagueName,
                        logo: match.league?.logo,
                        matches: []
                    };
                }
                matchesByLeague[leagueId].matches.push(match);
            });
            
            // Render leagues and matches
            let html = '';
            Object.values(matchesByLeague).forEach(league => {
                html += `
                    <div class="col-span-full">
                        <div class="match-card p-6 mb-6">
                            <div class="flex items-center justify-between mb-6">
                                <div class="flex items-center gap-3">
                                    ${league.logo ? 
                                        `<img src="${league.logo}" alt="${league.name}" class="w-10 h-10 object-contain">` : 
                                        `<div class="w-10 h-10 rounded-full bg-dark-lighter flex items-center justify-center">
                                            <i class="ph ph-trophy text-gray-400"></i>
                                        </div>`
                                    }
                                    <h3 class="text-xl font-bold">${league.name}</h3>
                                </div>
                                <span class="text-sm text-gray-400">${league.matches.length} Ù…Ø¨Ø§Ø±Ø§Ø©</span>
                            </div>
                            
                            <div class="space-y-4">
                `;
                
                league.matches.forEach(match => {
                    const isLive = ['1H', 'HT', '2H', 'ET'].includes(match.fixture.status.short);
                    const isFinished = match.fixture.status.short === 'FT';
                    const time = new Date(match.fixture.date).toLocaleTimeString('ar-SA', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    html += `
                        <div class="p-4 rounded-lg bg-dark-lighter light-mode:bg-gray-50 hover:bg-white/5 light-mode:hover:bg-gray-100 transition">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    ${isLive ? 
                                        `<span class="live-indicator px-3 py-1 rounded-full text-xs font-bold text-white">Ù…Ø¨Ø§Ø´Ø±</span>` : 
                                        isFinished ? 
                                        `<span class="px-3 py-1 rounded-full text-xs font-bold bg-green-500/20 text-green-500">Ø§Ù†ØªÙ‡Øª</span>` :
                                        `<span class="px-3 py-1 rounded-full text-xs font-bold bg-blue-500/20 text-blue-500">${time}</span>`
                                    }
                                    ${match.fixture.status.elapsed ? 
                                        `<span class="text-sm font-bold">${match.fixture.status.elapsed}'</span>` : ''
                                    }
                                </div>
                                <span class="text-sm text-gray-400">${match.league.round || 'Ù…Ø±Ø­Ù„Ø©'}</span>
                            </div>
                            
                            <div class="grid grid-cols-3 items-center">
                                <!-- Home Team -->
                                <div class="flex items-center justify-end gap-3">
                                    <span class="font-bold text-lg">${match.teams.home.name}</span>
                                    <img src="${match.teams.home.logo}" 
                                         alt="${match.teams.home.name}"
                                         class="w-10 h-10 object-contain">
                                </div>
                                
                                <!-- Score -->
                                <div class="text-center">
                                    <div class="text-2xl font-black mb-1">
                                        ${match.goals.home ?? '0'} - ${match.goals.away ?? '0'}
                                    </div>
                                    <div class="text-xs text-gray-400">
                                        ${match.fixture.status.long}
                                    </div>
                                </div>
                                
                                <!-- Away Team -->
                                <div class="flex items-center justify-start gap-3">
                                    <img src="${match.teams.away.logo}" 
                                         alt="${match.teams.away.name}"
                                         class="w-10 h-10 object-contain">
                                    <span class="font-bold text-lg">${match.teams.away.name}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                            </div>
                        </div>
                    </div>
                `;
            });
            
            elements.matchesContainer.innerHTML = html;
            
            // Show/hide load more button
            elements.loadMoreMatchesBtn.style.display = 
                state.displayedMatches < state.filteredMatches.length ? 'block' : 'none';
        }

        // Change Date
        function changeDate(days) {
            const date = new Date(state.currentDate);
            date.setDate(date.getDate() + days);
            state.currentDate = date.toISOString().split('T')[0];
            elements.datePicker.value = state.currentDate;
            loadMatches(state.currentDate);
        }

        // Toggle Live Matches
        function toggleLiveMatches() {
            state.showLiveOnly = !state.showLiveOnly;
            
            if (state.showLiveOnly) {
                elements.liveMatchesBtn.classList.add('bg-primary', 'text-white');
                elements.liveMatchesBtn.classList.remove('bg-dark-lighter', 'light-mode:bg-gray-100');
            } else {
                elements.liveMatchesBtn.classList.remove('bg-primary', 'text-white');
                elements.liveMatchesBtn.classList.add('bg-dark-lighter', 'light-mode:bg-gray-100');
            }
            
            filterMatches();
        }

        // Load More Matches
        function loadMoreMatches() {
            state.displayedMatches += 12;
            renderMatches();
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
